# データのインポート・エクスポート

```{r, out.width=c('100%'), echo=F, message=F}
knitr::include_graphics(here::here("images", "Import_Export_1500x500.png"))
```

このページでは、ファイルを検索、インポート、およびエクスポートする方法について説明します。

-   **rio** パッケージを使用して、さまざまな種類のファイルを柔軟に `import()` および `export()` します。\

-   **here** パッケージを使用して、R プロジェクトルートに関連するファイルを検索する - これにより1台のコンピューターに固有のファイルパスによる煩雑化を防ぎます。\

-   以下のような具体的なインポートのシナリオがあります。

    -   特定の Excel シート\
    -   煩雑なヘッダーと行のスキップ\
    -   グーグルシートからのインポート\
    -   ウェブサイト上のデータから\
    -   API を用いて\
    -   [最新の]{.ul}ファイルの読み込み\

-   手動でのデータ入力\

-   RDS や RData などの R 特有のファイルタイプ\

-   ファイルやプロットのエクスポート/保存

<!-- ======================================================= -->

## **概要**

R に"データセット"をインポートする場合、一般的には、R 環境に新しい[データフレーム]{.ul}オブジェクトを作成し、フォルダディレクトリ内の特定のファイルパス/アドレスにあるインポートファイル（Excel、CSV、TSV、RDS など）として定義します。

他の統計プログラム（SAS、STATA、SPSS）で作成されたファイルを含め、多くの種類のファイルをインポート／エクスポートすることができます。また、関係データベースへの接続も可能です。

R には独自のデータフォーマットもあります。

-   RDS ファイル（.rds）は、データフレームなどの単一の R オブジェクトを保存します。これらは R 列クラスを維持するため、クリーンデータを保存するのに役立ちます。詳しくは[こちら](#import_rds)をご覧ください。\
-   RData ファイル（.Rdata）は、複数のオブジェクトや、R のワークスペース全体を保存するのに使用できます。詳しくは[こちら](#import_rdata)をご覧ください。

<!-- ======================================================= -->

## rio パッケージ

本書ではパッケージ **rio** を推奨しています。"rio" は"R I/O"（Input/Output）の略語です。

関数 `import()` および `export()` は、様々な種類のファイルを扱うことができます（例: .xlsx、.csv、.rds、.tsv）。これらの関数にファイルパス（ ".csv" のような拡張子を含む）を指定すると、**rio** は拡張子を読み取り、正しいツールを使用してファイルをインポートまたはエクスポートします。

**rio** を使う代わりに、他の多くのパッケージの関数を使うことができます。それぞれのパッケージは、ファイルの種類に特化しています。例えば、 `read.csv()` ( **base** R )、`read.xlsx()` ( **openxlsx** パッケージ)、`write_csv()` ( **readr** パッケージ)などです。これらの選択肢を覚えるのは大変ですが、**rio** の `import()` や `export()` を使うのは簡単です。

**rio** の関数 `import()` と `export()` は、ファイルの拡張子に基づいて、与えられたファイルに適切なパッケージと関数を使用します。**rio** がバックグラウンドで使用するパッケージや関数の表は、このページの最後をご覧ください。**rio** は、STATA、SAS、SPSSのファイルをはじめ、さまざまな種類のファイルのインポートにも使用することが可能です。

シェープファイルのインポート／エクスポートには、\[GIS の基礎\]　のページで紹介した他のパッケージが必要です。

## here パッケージ {#here パッケージ}

**here** パッケージとその関数 `here()` を用いて、ファイルの場所と保存場所をRに簡単に指示することができます。つまり、ファイルパスを作成します。

**here** パッケージは、 R プロジェクトと組み合わせて使用することで、 R プロジェクトのルートディレクトリ（トップレベルのフォルダ）に対する R プロジェクト内のファイルの場所を記述することができます。これは、 R プロジェクトを複数の人やコンピュータで共有したり、アクセスしたりする場合に便利です。これは、すべてのユーザーに共通の場所（ R プロジェクトのルート）からファイルパスを「開始」することで、異なるコンピュータ上のユニークなファイルパス（例*:* `"C:/Users/Laura/Documents..."` ）による煩雑さを避けることができます。

Rプロジェクトでの `here()` はこのように機能します。

-   **here** パッケージが R プロジェクト内で最初に読み込まれると、"ベンチマーク"または "アンカー"として、 R プロジェクトのルートフォルダに".here "という小さなファイルが配置されます。

-   *スクリプトでは、* R プロジェクトのサブフォルダ内のファイルを参照するために、関数 `here()` を使用し、[そのアンカーに基づいた]{.ul}ファイルパスを作成します。

-   ファイルパスを作成するには、以下のように、ルート以降のフォルダ名を引用符で囲み、カンマで区切り、最後にファイル名とファイル拡張子を記述します。

-   `here()` のファイルパスは、インポートとエクスポートの両方に使用できます。

例えば、以下では、関数 `import()` に、 `here()` で構築されたファイルパスが提供されています。

```{r, eval=F}
linelist <- import(here("data", "linelists", "ebola_linelist.xlsx"))
```

コマンド `here("data", "linelists", "ebola_linelist.xlsx")` は、実際には[ユーザーのコンピューターに固有の]{.ul}完全なファイルパスを示しています。

    "C:/Users/Laura/Documents/my_R_project/data/linelists/ebola_linelist.xlsx"

`here()` を用いた R コマンドは、 R プロジェクトにアクセスするすべてのコンピューターで正常に実行できるのが魅力です。

[**ヒント*:*** ".here" ルートがどこに設定されているかわからない場合は、空の括弧を使用して関数 `here()` を実行してください。　]{style="color: darkgreen;"}

[このリンク](https://here.r-lib.org/)に **here** パッケージの詳細が記載されています。

<!-- ======================================================= -->

## ファイルパス

データをインポートまたはエクスポートする際、ファイルパスを指定する必要があります。 次の3つの方法のいずれかを実行できます。

1)  [推奨]{.ul}: **here** パッケージで"相対"ファイルパスを指定する\
2)  "完全な"/"絶対的な"ファイルパスを指定する\
3)  手動でのファイル選択

### "相対"ファイルパス {.unnumbered}

R では、"相対"ファイルパスは、R プロジェクトのルートを[基準にした]{.ul}ファイルパスで構成されます。これにより、さまざまなコンピューターで機能する、より単純なファイルパスが可能になります（例えば、R プロジェクトが共有ドライブ上にある場合や、電子メールで送信される場合）。[上記](#here)のように、相対ファイルパスは **here** パッケージを使用することで容易になります。

`here()` で作成された相対ファイルパスの例を以下に示します。目的のファイルパスは、サブフォルダー "data" を含む R プロジェクト内にあり、その中にサブフォルダー "linelists" があり、そこに対象の .xlsx ファイルがあると想定します。

```{r, eval=F}
linelist <- import(here("data", "linelists", "ebola_linelist.xlsx"))
```

### "絶対"ファイルパス {.unnumbered}

絶対または"完全な"ファイルパスを `import()` などの関数に指定できますが、ユーザーの特定のコンピューターに固有であるため"壊れやすい"ため、[推奨されません]{.ul}。

以下は絶対ファイルパスの例です。Laura のコンピューターには、フォルダー "analysis" 、サブフォルダー "data" があり、その中にサブフォルダー "linelists" があり、そこに対象の .xlsx ファイルがあります。 。

```{r, eval=F}
linelist <- import("C:/Users/Laura/Documents/analysis/data/linelists/ebola_linelist.xlsx")
```

絶対ファイルパスについて注意すべき点がいくつかあります。

-   スクリプトを別のコンピューターで実行すると機能しないため、**絶対ファイルパスの使用は避けてください**。
-   上記の例のように、スラッシュ（`/`）を使用してください（注: これは Windows ファイルパスのデフォルトとは異なります）\
-   二重スラッシュで始まるファイルパス（"//..."など）は、R によって**認識されない**可能性が高く、エラーが発生します。文字で始まる「名前付き」または「文字付き」のドライブ（"J:"や"C:"など）にファイルを移動することを検討してください。この問題の詳細については、\[ディレクトリの操作\] のページを参照ください。

絶対ファイルパスが適切なシナリオの1つは、すべてのユーザーに対して同じフルファイルパスを持つ共有ドライブからファイルをインポートする場合です。

[[**ヒント:**]{.ul} すべての\\を/にすばやく変換するには、目的のコードを選択し、Ctrl + f（ Windows の場合）を使用し、"選択中"のオプションボックスをオンにしてから、置換機能を使用して変換します。]{style="color: darkgreen;"}

<!-- ======================================================= -->

### 手動でのファイル選択 {.unnumbered}

次のいずれかの方法でデータを手動でインポートできます。

1)  RStudio の Environment Pane にて、"データセットのインポート"をクリックし、データの種類を選択します。
2)  ファイル / データセットのインポート /（データの種類を選択）をクリックします\
3)  手動選択をハードコーディングするには、base R コマンドの `file.choose()`（括弧を空のまま）を使用して、ユーザーがコンピューターからファイルを手動で選択できる**ポップアップウィンドウ**を表示します。以下に例を示します。

```{r import_choose, eval=F}
# ファイルの手動選択。このコマンドを実行すると、ポップアップウィンドウが表示される。
# 選択したファイルパスがimport（）コマンドに提供される。

my_data <- import(file.choose())
```

[[**ヒント**]{.ul}：**ポップアップウィンドウ**が RStudio ウィンドウの後ろに表示される場合があります。]{style="color: darkgreen;"}

## データのインポート

`import()` を使用してデータセットをインポートするのは非常に簡単です。 ファイルパス（ファイル名とファイル拡張子を含む）を引用符で囲んで指定するだけです。 `here()` を使用してファイルパスを作成する場合は、上記の手順に従ってください。 以下にいくつかの例を示します。

"作業ディレクトリ"または R プロジェクトのルートフォルダにあるcsvファイルをインポートします。

```{r, eval=F}
linelist <- import("linelist_cleaned.csv")
```

R プロジェクトの "data" および "linelists" サブフォルダー（`here()` を使用して作成されたファイルパス）にある Excel ワークブックの最初のシートをインポートします。

```{r, eval=F}
linelist <- import(here("data", "linelists", "linelist_cleaned.xlsx"))
```

絶対ファイルパスを使用してデータフレーム（.rds ファイル）をインポートする。

```{r, eval=F}
linelist <- import("C:/Users/Laura/Documents/tuberculosis/data/linelists/linelist_cleaned.rds")
```

### 特定の Excel シート {.unnumbered}

特定の**シート**をインポートする場合は、シート名を `which =` 引数に含めます。 以下に例を示します。

```{r eval=F}
my_data <- import("my_excel_file.xlsx", which = "Sheetname")
```

`here()` を使用して `import()` への相対パスを提供する場合でも、`here()` 関数の閉じ括弧の後に `which =` 引数を追加することで、特定のシートを指定することができます。

```{r import_sheet_here, eval=F}
#デモ: 'here'パッケージで相対パスを使用し特定の Excel シートをインポートする
linelist_raw <- import(here("data", "linelist.xlsx"), which = "Sheet1")`  
```

データフレームを R から特定の Excel シートに[エクスポート]{.ul}し、 Excel ワークブックの残りの部分を変更しないようにするには、**openxlsx** など、この目的に対応した代替パッケージを使用してインポート、編集、およびエクスポートする必要があります。詳細については、\[ディレクトリの操作\] のページまたは[この github ページ](https://ycphs.github.io/openxlsx/)を参照してください。

Excel ワークブックが .xlsb（バイナリ形式の Excel ワークブック）の場合、rio を使用してインポートできない場合があります。 .xlsx として再保存するか、[こういった目的](https://cran.r-project.org/web/packages/readxlsb/vignettes/read-xlsb-workbook.html)のために作成された **readxlsb** のようなパッケージを使用することを検討してください。

<!-- ======================================================= -->

### 欠損値 {#import_missing .unnumbered}

データセット内のどういった値が欠損していると見なされるかをまず指定することが大切です。\[データの欠損\] のページで説明されているように、R では欠損値は `NA` と表示されますが、インポートするデータセットは、代わりに99、 "Missing"、または単に空の文字スペース ""を使用します。

`import()` に`na =` 引数を使用し、値を引用符で囲んで指定します（数値の場合でも同様に）。 以下に示すように、 `c()` を使用して、ベクトル内に複数の値を含めることで複数の値を指定できます。

インポートされたデータセットの値 "99" は欠落していると見なされ、Rで `NA` に変換されます。

```{r, eval=F}
linelist <- import(here("data", "my_linelist.xlsx"), na = "99")
```

インポートされたデータセットの "Missing"、""（空のセル）、または " "（単一スペース）の値はすべて、Rで `NA` に変換されます。

```{r, eval=F}
linelist <- import(here("data", "my_linelist.csv"), na = c("Missing", "", " "))
```

<!-- ======================================================= -->

### 行をスキップする {.unnumbered}

.xlsx または .csv ファイル上で一部の行のインポートを避けたい場合は、 **rio** の `import()` 内で引数 `skip =` を使用します。 インポートをスキップする行数を指定します。

```{r, eval=F}
linelist_raw <- import("linelist_raw.xlsx", skip = 1)  # ヘッダー行をインポートしない
```

残念ながら、範囲[ではなく]{.ul}、整数値のみが`skip =` により実行されます（たとえば、"2:10" は機能しません）。上から連続していない特定の行のインポートをスキップするには、複数回インポートし、**dplyr** パッケージのから `bind_rows()` を使用することを検討してください。 以下に二行目のみをスキップする例を示します。

### 2番目のヘッダー行を管理する {.unnumbered}

以下に示すように、データが、データに[2番目]{.ul}の行がある場合があります（例えば "データディクショナリ" 行である場合など）。この場合、すべての列がクラス "文字" としてインポートされる可能性があるため、問題になる可能性があります。

```{r, echo=F}
# HIDDEN FROM READER
####################
# Create second header row of "data dictionary" and insert into row 2. Save as new dataframe.
linelist_2headers <- rio::import(here::here("data", "case_linelists", "linelist_cleaned.rds")) %>%         
        mutate(across(everything(), as.character)) %>% 
        add_row(.before = 1,
                #row_num = "000",
                case_id = "case identification number assigned by MOH",
                generation = "transmission chain generation number",
                date_infection = "estimated date of infection, mm/dd/yyyy",
                date_onset = "date of symptom onset, YYYY-MM-DD",
                date_hospitalisation = "date of initial hospitalization, mm/dd/yyyy",
                date_outcome = "date of outcome status determination",
                outcome = "either 'Death' or 'Recovered' or 'Unknown'",
                gender = "either 'm' or 'f' or 'unknown'",
                hospital = "Name of hospital of first admission",
                lon = "longitude of residence, approx",
                lat = "latitude of residence, approx",
                infector = "case_id of infector",
                source = "context of known transmission event",
                age = "age number",
                age_unit = "age unit, either 'years' or 'months' or 'days'",
                fever = "presence of fever on admission, either 'yes' or 'no'",
                chills = "presence of chills on admission, either 'yes' or 'no'",
                cough = "presence of cough on admission, either 'yes' or 'no'",
                aches = "presence of aches on admission, either 'yes' or 'no'",
                vomit = "presence of vomiting on admission, either 'yes' or 'no'",
                time_admission = "time of hospital admission HH:MM")
```

以下は、この種のデータセットの例です（最初の行はデータディクショナリです）。

```{r message=FALSE, echo=F}
# ラインリストデータをテーブルとして表示する
DT::datatable(head(linelist_2headers, 5), rownames = FALSE, filter="top", options = list(pageLength = 4, scrollX=T), class = 'white-space: nowrap' )
```

#### 2番目のヘッダー行の削除 {.unnumbered}

2番目のヘッダー行を削除するには、データを2回インポートする必要があります。

1)  正しい列名を保存するためにデータをインポートします。\
2)  最初の2行（ヘッダーと2行目）をスキップして、データを再度インポートします\
3)  縮小されたデータフレームに正しい名前を指定します

正しい列名を指定するために使用される正確な引数は、データファイルのタイプ（.csv、.tsv、.xlsx など ）によって異なります。これは、**rio** がファイルタイプごとに異なる関数を使用しているためです（上記の表を参照）。

**エクセルファイルの場合:** (`col_names =`)

```{r, eval=F}
# 1回目のインポートでは列名を保存する
linelist_raw_names <- import("linelist_raw.xlsx") %>% names()  # 本来の列名を保存する

# 2回目のインポートでは、二行目をスキップし、列名を引数col_names = に割り当てる
linelist_raw <- import("linelist_raw.xlsx",
                       skip = 2,
                       col_names = linelist_raw_names
                       ) 
```

**CSVファイルの場合:** (`col.names =`)

```{r, eval=F}
# 1回目のインポートでは列名を保存する
linelist_raw_names <- import("linelist_raw.csv") %>% names() # 本来の列名を保存する

# csvファイルの引数は 'col.names='であることに注意
linelist_raw <- import("linelist_raw.csv",
                       skip = 2,
                       col.names = linelist_raw_names
                       ) 
```

**バックアップオプションとして** - 列名を別のコマンドとして変更する

```{r, eval=F}
# base R の関数の colnames() 関数を使用してヘッダーを割り当てる/上書きする
colnames(linelist_raw) <- linelist_raw_names
```

#### データディクショナリの作成 {.unnumbered}

ボーナス！データディクショナリである2行目がある場合は、そこから適切なデータディクショナリを簡単に作成できます。このヒントは、この[投稿](https://alison.rbind.io/post/2018-02-23-read-multiple-header-rows/)を基にしています。

```{r}
dict <- linelist_2headers %>%             # はじめに、一行目としてディクショナリを含むラインリスト
  head(1) %>%                             # 列名とディクショナリの一行目のみを保持する           
  pivot_longer(cols = everything(),       # すべての列を長い形式に変更する
               names_to = "Column",       # 新しい列名を割り当てる
               values_to = "Description")
```

```{r message=FALSE, echo=F}
DT::datatable(dict, rownames = FALSE, filter="top", options = list(pageLength = 4, scrollX=T), class = 'white-space: nowrap' )
```

#### 2つのヘッダー行を組み合わせる {.unnumbered}

元のデータセットにヘッダーが[二行]{.ul}がある場合（特に、データの2行目がセカンダリヘッダーである場合）、それらを "結合" するか、2番目のヘッダー行の値を最初のヘッダー行に追加することができます。

以下のコマンドは、データフレームの列名を、最初の（本来の）ヘッダーとそのすぐ下（最初の行）の値の組み合わせ（一緒に貼り付ける）として定義します。

```{r, eval=F}
names(my_data) <- paste(names(my_data), my_data[1, ], sep = "_")
```

<!-- ======================================================= -->

### グーグルシート {.unnumbered}

**googlesheet4** パッケージを使用し、スプレッドシートへのアクセスを認証することにより、オンラインの Google スプレッドシートからデータをインポートすることができます。

```{r, eval=F}
pacman::p_load("googlesheets4")
```

以下のように、デモの Google シートをインポートして保存します。このコマンドは、 Google アカウントの認証の確認を求める場合があります。インターネットブラウザのプロンプトとポップアップに従って、Tidyverse API パッケージに、 Google ドライブでスプレッドシートを編集、作成、および削除する権限を付与します。

以下のシートは "リンクを持っている人は誰でも閲覧可能" と設定されているので、インポートすることができます。

```{r, eval=F}
Gsheets_demo <- read_sheet("https://docs.google.com/spreadsheets/d/1scgtzkVLLHAe5a6_eFQEwkZcc14yFUx1KgOMZ4AKUfY/edit#gid=0")
```

シートは、URLの短い部分であるシート ID のみを使用してインポートすることもできます。

```{r, eval=F}
Gsheets_demo <- read_sheet("1scgtzkVLLHAe5a6_eFQEwkZcc14yFUx1KgOMZ4AKUfY")
```

別のパッケージである **googledrive** は、 Google スプレッドシートの作成、編集、削除に役立つ機能を提供します。たとえば、このパッケージにある `gs4_create()` 関数と `sheet_write()` 関数を使用します。

その他のオンライン資料:\
[Google スプレッドシートのインポート {基礎}](https://arbor-analytics.com/post/getting-your-data-into-r-from-google-sheets/)\
[より詳しいチュートリアル](https://googlesheets4.tidyverse.org/articles/googlesheets4.html)\
[googlesheets4 と tidyverse の間の相互作用](https://googlesheets4.tidyverse.org/articles/articles/drive-and-sheets.html)

## 複数のファイルをインポート、エクスポート、分割、結合する

複数のファイルまたは複数のExcelブックファイルをインポートして結合する方法の例については、 \[ループと反復処理・リストの操作\] のページを参照してください。このページでは、データフレームをパーツに分割し、それぞれを個別にエクスポートする方法、または Excel ワークブックの名前付きシートとしてエクスポートする方法の例も紹介しています。

<!-- ======================================================= -->

## Github からのインポート {#Github からのインポート}

ファイルの種類により、Github から R にデータを直接インポートするのは非常に簡単な場合もあれば、いくつかの手順が必要な場合もあります。 以下にいくつかのアプローチを示します。

### CSV ファイル {.unnumbered}

R コマンドを使用して、.csv ファイルを Github から R に容易に直接インポートすることができます。

1)  Github リポジトリに移動し、目的のファイルを見つけてクリックします\

2)  "Raw" ボタンをクリックします（次に示すように、 "Raw" の csv データが表示されます）

3)  URL（ウェブアドレス）をコピーします\

4)  `import()` Rコマンド内でURLを引用符で囲みます

```{r, out.width=c('100%', '100%'), fig.align = "left", echo=F}
knitr::include_graphics(here::here("images", "download_csv_raw.png"))
```

### XLSX ファイル {.unnumbered}

一部のファイル（.xlsx、.rds、.nwk、.shp など）の "Raw" データを表示できない場合があります

1)  Githubリポジトリに移動し、目的のファイルを見つけてクリックします\
2)  以下に示すように、"Download" ボタンをクリックします\
3)  ファイルをコンピューターに保存し、 R にインポートします

```{r , out.width=c('100%', '100%'), fig.align = "left", echo=F}
knitr::include_graphics(here::here("images", "download_xlsx.png"))
```

### シェイプファイル {.unnumbered}

シェイプファイルには多くのサブコンポーネントファイルがあり、それぞれファイル拡張子が異なります。ファイル拡張子が ".shp"であるものもあれば、".dbf"、".prj" などのものもあります。Github からシェイプファイルをダウンロードするには、各サブコンポーネントファイルを個別にダウンロードし、コンピューターの[同じ]{.ul}フォルダーに保存する必要があります。Github で、各ファイルを個別にクリックし、"ダウンロード" ボタンをクリックしてダウンロードします。

コンピュータに保存したら、**sf** パッケージの `st_read()` を使用して、\[GIS の基礎\] ページに示されているようにシェープファイルをインポートできます。他の関連ファイルがコンピューターの同じフォルダー内にある場合に限り、".shp" ファイルのファイルパスと名前を指定するだけで済みます。

以下に、シェープファイル "sle_adm3" が多くのファイルで構成されていることを示します。各ファイルはGithubからダウンロードする必要があります。

```{r , out.width=c('100%', '100%'), fig.align = "left", echo=F}
knitr::include_graphics(here::here("images", "download_shp.png"))
```

<!-- ======================================================= -->

## 手動でのデータ入力

### 行ごとの入力 {.unnumbered}

tidyverse の **tibble** パッケージの `tribble` 関数を使用します([tribble のオンライン資料はこちら](https://tibble.tidyverse.org/reference/tribble.html)) 。

列のヘッダーが[チルダ]{.ul} (`~`) で始まります。また、各列のデータクラス（文字、数値など）は一つのみしか与えられないことに注意してください。タブ、間隔、および新しい行を使用して、データ入力をより直感的で読みやすくすることができます。値の間にスペースは関係ありませんが、各行は新しいコード行で表されます。 以下に例を示します。

```{r import_manual_row}
# 行ごとに手動でデータセットを作成する
manual_entry_rows <- tibble::tribble(
  ~colA, ~colB,
  "a",   1,
  "b",   2,
  "c",   3
  )
```

新しいデータセットは以下のコマンドで表示できます。

```{r, echo=F}
# 新しいデータセットを表示する
DT::datatable(manual_entry_rows)
```

### 列ごとの入力 {.unnumbered}

データフレームはベクトル（垂直列）で構成されているため、R で手動でデータフレームを作成する**基本的**なアプローチでは、各列を定義してから結合します。通常、上記に示したようにデータを行で考えるため、疫学では直感に反するかもしれません。

```{r import_manual_col}
# 各ベクトル（垂直列）を個別に定義し、それぞれに独自の名前を付ける
PatientID <- c(235, 452, 778, 111)
Treatment <- c("Yes", "No", "Yes", "Yes")
Death     <- c(1, 0, 1, 0)
```

[[**注意**]{.ul}**:**すべてのベクトルは同じ長さ（同じ数の値）である必要があります。]{style="color: orange;"}

次に、関数 `data.frame()` を使用してベクトルを結合できます。

```{r}
# ベクトル名を元に、列をデータフレームに結合する
manual_entry_cols <- data.frame(PatientID, Treatment, Death)
```

以下のように新しいデータセットを表示します。

```{r, echo=F}
# 新しいデータセットを表示する
DT::datatable(manual_entry_cols)
```

### クリップボードをインポート {.unnumbered}

他の場所からデータをコピーしてクリップボードに保存する場合は、次の2つの方法のいずれかを試すことができます。

**clipr** パッケージから、 `read_clip_tbl()` を使用してデータフレームとしてインポートするか、単に `read_clip()` を使用して文字ベクトルとしてインポートすることができます。どちらの場合も、括弧は空のままにしておきます。

```{r, eval=F}
linelist <- clipr::read_clip_tbl()  # 現在のクリップボードをデータフレームとしてインポートする
linelist <- clipr::read_clip()      # 文字ベクトルとしてインポートする
```

また、 パッケージ **clipr** を使用してシステムのクリップボードに簡単にエクスポートすることもできます。 エクスポートについては、以下のセクションを参照してください。

または、 `file = "clipboard")` を指定して **base** R の `read.table()` 関数を使用して、データフレームとしてインポートすることもできます。

```{r, eval=F}
df_from_clipboard <- read.table(
  file = "clipboard",  # これを"クリップボード"として指定する
  sep = "t",           # 区切り文字はタブ、またはコンマなどが指定可能
  header=TRUE)         # ヘッダー行がある場合
```

## 最新のファイルをインポート

多くの場合、データセットの更新を毎日受け取ることがあります。 この場合、最新のファイルをインポートするコードを記述します。 以下に、これにアプローチする2つの方法を示します。

-   ファイル名の日付に基づいてファイルを選択する\
-   ファイルメタデータ（最新の変更）に基づくファイルの選択

### ファイル名の日付を用いて {.unnumbered}

このアプローチは、次の3つの前提条件を要します。

1)  ファイル名の日付が信頼できるものであること\
2)  日付は数値であり、[一般敵に]{.ul}同じ形式で表示されていること（たとえば、年、月、日）\
3)  ファイル名に日付以外の番号が書かれていないこと

各ステップについて説明し、最後にそれらを組み合わせて示します。

まず、**base** R から `dir()` を使用して、対象のフォルダー内の各ファイルのファイル名だけを抽出します。`dir()` の詳細については、\[ディレクトリの操作\] のページを参照してください。 この例では、対象のフォルダーは、R プロジェクトにある "data" 内、そして "example" フォルダー内の "linelists" フォルダーです。

```{r}
linelist_filenames <- dir(here("data", "example", "linelists")) # フォルダからファイル名を取得
linelist_filenames                                              # 表示
```

この名前ベクトルを取得したら、この正規表現を使用して **stringr** から `str_extract()` を適用することにより、名前から日付を抽出できます。ファイル名の任意の数字（ダッシュやスラッシュなどの中央にある他の文字を含む）を抽出します。 **stringr** の詳細については、 \[文字列型データ\] ページをご覧ください。

```{r}
linelist_dates_raw <- stringr::str_extract(linelist_filenames, "[0-9].*[0-9]") # 数字とその間の文字を抽出
linelist_dates_raw  # 表示
```

日付が一般的に同じ日付形式（たとえば、年、月、日）で記述され、年が4桁であると仮定すると、**lubridate** の柔軟な変換関数（`ymd()`、`dmy()`、または `mdy()`）を使用して、それらを日付に変換できます。こういった関数の場合、ダッシュ、スペース、またはスラッシュは重要ではなく、番号の順序のみが重要です。 詳しくは \[日付型データ\] ページをご覧ください。

```{r}
linelist_dates_clean <- lubridate::ymd(linelist_dates_raw)
linelist_dates_clean
```

次に、**base** R 関数 `which.max()` を使用して、最大日付値のインデックス位置（1番目、2番目、3番目など）を取得することができます。最新のファイルは、6番目のファイル "case_linelist_2020-10-08.xlsx" として正しく識別されます。

```{r}
index_latest_file <- which.max(linelist_dates_clean)
index_latest_file
```

これらすべてのコマンドをまとめたコードは次のようになります。最後の行の `.` は、パイプシーケンスのそのポイントでのパイプオブジェクトのプレースホルダーであることに注意してください。その時点での値は単純に数字の6です。これは二重括弧で囲まれ、 `dir()` によって生成されたファイル名のベクトルの6番目の要素を抽出します。

```{r}
# パッケージを読み込む
pacman::p_load(
  tidyverse,         # データ整理
  stringr,           # 文字列/文字の操作
  lubridate,         # 日付の処理
  rio,               # データのインポート・エクスポート
  here,              # 相対ファイルパス
  fs)                # ディレクトリの相互作用

# 最新ファイルのファイル名を抽出します
latest_file <- dir(here("data", "example", "linelists")) %>%  # "linelists" サブフォルダからのファイル名          
  str_extract("[0-9].*[0-9]") %>%                  # 日付（数字）を抽出
  ymd() %>%                                        # 数値を日付に変換（年-月-日形式を想定）
  which.max() %>%                                  # 最大日付のインデックスを取得（最新のファイル）
  dir(here("data", "example", "linelists"))[[.]]              # 最新のラインリストのファイル名を取得

latest_file  # 最新のファイルの名前を表示する
```

これで、`here()` を使い、上記の名前を使用して、相対ファイルパスを完成させることができます。

```{r, eval=F}
here("data", "example", "linelists", latest_file) 
```

これで、最新のファイルをインポートできます。

```{r, eval=F}
# インポート
import(here("data", "example", "linelists", latest_file)) # インポート 
```

### ファイル情報を用いて {.unnumbered}

ファイルの名前に日付が含まれていない場合（またはそれらの日付を信頼できない場合）、ファイルのメタデータから最終変更日を抽出してみてください。パッケージ **fs** の関数を使用して、最終変更時刻とファイルパスを含む各ファイルのメタデータ情報を調べます。

以下のように、 **fs** の `dir_info()` に対象のフォルダーを提供します。この場合、対象のフォルダーは、フォルダー "data"、サブフォルダー"example"、およびそのサブフォルダー"linelists"の R プロジェクトにあります。結果は、ファイルごとに1行、 `modification_time`, `path` などの列を持つデータフレームです。この視覚的な例は、\[ディレクトリの操作\]　のページで確認できます。

このファイルのデータフレームを列`modification_time` で並べ替えてから、**base** Rの `head()` を含む最上位/最新の行（ファイル）のみを保持できます。次に、列パスの **dplyr** 関数 `pull()` を使用してのみ、この最新ファイルのファイルパスを抽出できます。Finally we can pass this file path to `import()`. The imported file is saved as `latest_file`.最後に、このファイルパス `import()` 内で指定し、インポートされたファイルは `latest_file` として保存されます。

```{r, eval=F}
latest_file <- dir_info(here("data", "example", "linelists")) %>%  # ディレクトリ内の全ファイルのファイル情報を収集
  arrange(desc(modification_time)) %>%      # 変更時間で並べ替え
  head(1) %>%                               # 一番上の（最新の）ファイルのみを保持する
  pull(path) %>%                            # ファイルパスのみを抽出
  import()                                  # ファイルをインポート

```

<!-- ======================================================= -->

## APIs {#import_api}

"自動プログラミングインターフェース"（API）を使用して、Web サイトからデータを直接リクエストできます。API は、あるソフトウェアアプリケーションが別のソフトウェアアプリケーションと対話できるようにする一連のルールです。クライアント（あなた）は "リクエスト" を送信し、コンテンツを含む "レスポンス" を受信します。R パッケージ **httr** および **jsonlite** により、このプロセスを容易に行うことができます。

API 対応の各ウェブサイトには、知っておくべき独自のドキュメントと詳細があります。一部のサイトは公開されており、誰でもアクセス可能です。ユーザー ID や経歴を備えたプラットフォームなど、その他のデータにアクセスするには認証が必要です。

言うまでもなく、API を介してデータをインポートするにはインターネットに接続する必要があります。以下において、API を使用してデータをインポートする例を簡単に説明し、その他資料を紹介します。

\*[注]{.ul}: API を使用せずにウェブサイトに[データが投稿される可能性がある]{.ul}ことに注意してください。これにより、取得が容易になる場合があります。たとえば、投稿された CSV ファイルには、[Github からのインポート](#Github%20からのインポート)に関するセクションで説明されているように `import()` にサイトの URL を指定するだけでアクセスできます。\*

### HTTP リクエスト {.unnumbered}

API 交換は、最も一般的には HTTP リクエストを介して行われます。HTTP はハイパーテキスト転送プロトコル（Hypertext Transfer Protocol）であり、クライアントとサーバー間の要求/応答の基本的な形式です。正確な入力と出力は API のタイプによって異なる場合がありますが、プロセスは同じです。ユーザーからの "リクエスト"（多くの場合 HTTP リクエスト）にはクエリが含まれ、その後に "レスポンス" が続き、リクエストと場合によってはリクエストされたコンテンツについてのステータス情報が含まれます。

[HTTP リクエスト]{.ul}のいくつかのコンポーネントは次のとおりです。

-   API エンドポイントの URL\
-   "メソッド"（または "動詞"）\
-   ヘッダー\
-   本文

HTTP リクエストの "メソッド で"は、実行したいアクションを指定します。最も一般的な HTTP メソッド2つは `GET` と `POST` ですが、その他には `PUT`, `DELETE`, `PATCH` などがあります。R にデータをインポートする場合、 `GET` を使用する可能性が最も高いです。

リクエスト後、コンピュータは、URL、HTTP ステータス（ステータス200が必要です！）、ファイルタイプ、サイズ、目的のコンテンツなど、送信したものと同様の形式で "応答" を受け取ります。次に、この応答を解析して、R 環境内で実行可能なデータフレームに変換する必要があります。

### パッケージ {.unnumbered}

**httr** パッケージは、R で HTTP リクエストを処理するのに適しています。ウェブ APIの予備知識はほとんど必要なく、ソフトウェア開発用語にあまり詳しくない方でも利用することができます。また、HTTP レスポンスが .json の場合、**jsonlite** を使用してレスポンスを解析することができます。

```{r, eval=F}
# パッケージを読み込む
pacman::p_load(httr, jsonlite, tidyverse)
```

### 公開されているデータ {.unnumbered}

以下は、[Trafford Data Lab](https://www.trafforddatalab.io/open_data_companion/#A_quick_introduction_to_APIs) のチュートリアルから借用した HTTP リクエストの例です。このサイトには、他にも学習用の資料や API の演習がいくつかあります。

シナリオ: イギリスの Trafford 市にあるファーストフードの店舗リストをインポートしたい。このデータは、イギリスの食品衛生評価データを提供する Food Standards Agency の API からアクセスすることができる。

今回のリクエストのパラメータは以下の通りです。

-   HTTP 動詞: GET\
-   API エンドポイント URL: <http://api.ratings.food.gov.uk/Establishments>\
-   選択したパラメーター: name, address, longitude, latitude, businessTypeId, ratingKey, localAuthorityId\
-   ヘッダー: "x-api-version", 2\
-   データフォーマット: JSON, XML\
-   ドキュメンテーション: <http://api.ratings.food.gov.uk/help>

Rコードは次のようになります。

```{r, eval=F, warning=F, message=F}
# リクエストの準備
path <- "http://api.ratings.food.gov.uk/Establishments"
request <- GET(url = path,
             query = list(
               localAuthorityId = 188,
               BusinessTypeId = 7844,
               pageNumber = 1,
               pageSize = 5000),
             add_headers("x-api-version" = "2"))

# サーバーエラーがないか確認（"200"が望ましい）
request$status_code

# リクエストを送信し、レスポンスを解析して、データフレームに変換
response <- content(request, as = "text", encoding = "UTF-8") %>%
  fromJSON(flatten = TRUE) %>%
  pluck("establishments") %>%
  as_tibble()
```

これで、ファーストフード施設ごとに1行を含む `response` データフレームをクリーンアップして使用できるようになりました。

### **認証が必要なデータ** {.unnumbered}

一部のAPIには認証が必要です。自分が誰であるかを証明することで、制限されたデータにアクセスできます。このようなデータをインポートするには、まず POST メソッドを使用して、ユーザー名、パスワード、またはコードを提供する必要がある場合があります。これにより、目的のデータを取得するためにその後の GET メソッドのリクエストで使用できるアクセストークンを取得できます。

以下に、アウトブレイク調査ツールである [Go.Data]{.ul} からデータをクエリする例を示します。[Go.Data]{.ul} は、データ収集に使用される Web フロントエンドとスマートフォンアプリケーション間のすべてのインタラクションに API を使用しています。[Go.Data]{.ul} は世界中で使用されています。アウトブレイクデータは機密性が高く、[自分の]{.ul}アウトブレイクに関するデータにしかアクセスできないため、認証が必要です。

以下に、[Go.Data]{.ul} APIに接続して発生からの連絡先フォローアップに関するデータをインポートするために **httr** と **jsonlite** を使用したサンプル R コードを示します。

```{r, eval=F}
# 認可のための認証情報を設定
url <- "https://godatasampleURL.int/"           # 有効な Go.Data URL の例
username <- "username"                          # 有効な Go.Data ユーザー名 
password <- "password"                          # 有効な Go,Data パスワード
outbreak_id <- "xxxxxx-xxxx-xxxx-xxxx-xxxxxxx"  # 有効な Go.Data アウトブレイク ID

# アクセストークンを取得する
url_request <- paste0(url,"api/oauth/token?access_token=123") # ベース URL リクエストを定義する

# リクエストの準備
response <- POST(
  url = url_request,  
  body = list(
    username = username,    # 上記から保存したユーザー名/パスワードを使用して認証する                               
    password = password),                                       
    encode = "json")

# リクエストの実行と応答の解析
content <-
  content(response, as = "text") %>%
  fromJSON(flatten = TRUE) %>%          # ネストした JSON をフラット化する
  glimpse()

# 応答から得られたアクセストークンを保存する
access_token <- content$access_token    # アクセストークンを保存して、以下の後続の API 呼び出しを許可します

# アウトブレイクの連絡先をインポートする
# アクセストークンを使用する 
response_contacts <- GET(
  paste0(url,"api/outbreaks/",outbreak_id,"/contacts"),          # GET リクエスト
  add_headers(
    Authorization = paste("Bearer", access_token, sep = " ")))

json_contacts <- content(response_contacts, as = "text")         # テキスト JSON に変換

contacts <- as_tibble(fromJSON(json_contacts, flatten = TRUE))   # JSON をフラット化して tibble として保存
```

[[**注意:**]{.ul}認証が必要な API から大量のデータをインポートする場合、タイムアウトになる場合があります。 これを回避するには、各 API GET リクエストの前にアクセストークンを再度取得し、クエリでフィルターまたは制限を使用してみてください。.]{style="color: orange;"}

[[***ヒント:***]{.ul}**jsonlite** パッケージの `fromJSON()` 関数では、最初の実行では完全にネストが解除されないため、tibble にリストアイテムが残っている可能性があります。**.json** がどの程度ネストされているかに応じて、特定の変数のネストをさらに解除する必要があります。この情報の詳細については、[`flatten()`関数](https://rdrr.io/cran/jsonlite/man/flatten.html)などの **jsonlite** パッケージの説明をご覧ください。]{style="color: darkgreen;"}

詳細は、LoopBack Explorer のドキュメント、[Go.Data Github レポジトリ](https://worldhealthorganization.github.io/godata/api-docs)の \[接触者の追跡\] ページ、または API tips をご覧ください。

[httr]{.ul} パッケージの詳細は[こちら](https://httr.r-lib.org/articles/quickstart.html)をご覧ください。

このセクションは、[このチュートリアル](https://www.dataquest.io/blog/r-api-tutorial/)と[こちらのチュートリアル](https://medium.com/@traffordDataLab/querying-apis-in-r-39029b73d5f1) を参照しました。

<!-- ======================================================= -->

## エクスポート

### rio パッケージを使って {.unnumbered}

**rio** を使用すると、`import()` と同様の方法で `export()` 関数を使用できます。まず、保存する R オブジェクトの名前（`linelist` など）を指定してから、ファイルを保存する場所に、目的のファイル名とファイル拡張子を含むファイルパスを引用符で囲みます。例を以下に示します。

以下のコードの実行により、データフレーム `linelist` がExcel ワークブックとして作業ディレクトリ/ R プロジェクトのルートフォルダに保存されます。

```{r, eval=F}
export(linelist, "my_linelist.xlsx") # 作業ディレクトリに保存する
```

拡張子を変更することで、csv ファイルと同じデータフレームを保存できます。 たとえば、 `here()` で作成されたファイルパスにも保存します。

```{r, eval=F}
export(linelist, here("data", "clean", "my_linelist.csv"))
```

### クリップボードにエクスポート {.unnumbered}

データフレームをコンピューターの "クリップボード" にエクスポートするには（Excel、Google スプレッドシートなどの別のソフトウェアに貼り付けるため）、**clipr** パッケージの`write_clip()` を使用できます。

```{r, eval=F}
# ラインリストデータフレームをシステムのクリップボードにエクスポートする
clipr::write_clip(linelist)
```

## RDS ファイル {#import_rds}

.csv、.xlsx などに加えて、R データフレームを .rds ファイルとしてエクスポート/保存することもできます。 これはRに固有のファイル形式であり、エクスポートされたデータを R で再度操作することがわかっている場合に非常に役立ちます。

列のクラス（型）はそのまま保存されるため、インポート時に再度整理する必要はありません（Excel や CSV ファイルでは、これは頭痛の種になります!）。また、TIt はファイルサイズが小さいので、データセットが大きい場合、エクスポートやインポートに便利です。

例えば、R を使用している疫学チームに所属していて、マッピングのために GIS チームにファイルを送る必要がある場合 .rds ファイルを使用すると、すべての列クラス（型）が保持され、便利です。

```{r, eval=F}
export(linelist, here("data", "clean", "my_linelist.rds"))
```

<!-- ======================================================= -->

## Rdata ファイルとリスト {#import_rdata}

`.Rdata` ファイルには、複数の R オブジェクト（複数のデータフレーム、モデリングの結果、リストなど）を保存できます。これは、特定のプロジェクトの多くのデータをまとめたり共有するのに非常に役立ちます。

次の例では、複数の R オブジェクトがエクスポートされたファイル "my_objects.Rdata" 内に保存されています。

```{r, eval=F}
rio::export(my_list, my_dataframe, my_vector, "my_objects.Rdata")
```

注: リストをインポートする場合は、**rio** から `import_list()` を使って、オリジナルの完全なデータ構造と内容でインポートしてください。

```{r, eval=F}
rio::import_list("my_list.Rdata")
```

<!-- ======================================================= -->

## プロットの保存

`ggplot()` によって作成されたプロットを保存する方法の説明は、 \[ggplot の基礎\] ページで詳しく説明されています。

簡単に説明すると、プロットを表示した後、 `ggsave("my_plot_filepath_and_name.png")` を実行します。引数 `plot =` では、保存されたプロットオブジェクトを指定することが、あるいは、最も最近表示されたプロットを保存するための保存先ファイルパス (ファイル拡張子付き) のみを指定も可能です。`width =`、`height =`、`units =`、そして `dpi =`.を設定することもできます。

送信ツリーなどのネットワークグラフを保存する方法については、\[送信チェーン\] のページをご覧ください。

<!-- ======================================================= -->

## 資料

[R データインポート・エクスポートマニュアル](https://cran.r-project.org/doc/manuals/r-release/R-data.html)\
[データサイエンスのための R データインポートについての章](https://r4ds.had.co.nz/data-import.html#data-import)\
[ggsave() について](https://ggplot2.tidyverse.org/reference/ggsave.html)

以下は、**rio** オンライン[資料](https://cran.r-project.org/web/packages/rio/vignettes/rio.html)から抜粋した表です。データの種類ごとに、予想されるファイル拡張子、データのインポートまたはエクスポートに **rio** で使用されるパッケージ、この機能がデフォルトでインストールされたバージョンの **rio** に含まれているかどうかが表示されています。

+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| フォーマット                         | **一般的拡張子**             | インポート用パッケージ | エクスポート用パッケージ | デフォルトでインストールされているかの有無 |
+======================================+==============================+========================+==========================+============================================+
| カンマ区切りデータ                   | .csv                         | data.table `fread()`   | data.table               | 有                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| パイプ区切りデータ                   | .psv                         | data.table `fread()`   | data.table               | 有                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| タブ区切りデータ                     | .tsv                         | data.table `fread()`   | data.table               | 有                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| SAS                                  | .sas7bdat                    | haven                  | haven                    | 有                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| SPSS                                 | .sav                         | haven                  | haven                    | 有                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| Stata                                | .dta                         | haven                  | haven                    | 有                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| SAS                                  | XPORT                        | .xpt                   | haven                    | haven                                      |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| SPSS ポータブル                      | .por                         | haven                  |                          | 有                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| Excel                                | .xls                         | readxl                 |                          | 有                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| Excel                                | .xlsx                        | readxl                 | openxlsx                 | 有                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| R シンタックス                       | .R                           | base                   | base                     | 有                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| 保存された R オブジェクト            | .RData, .rda                 | base                   | base                     | 有                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| シリアル化された R オブジェクト      | .rds                         | base                   | base                     | 有                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| Epiinfo                              | .rec                         | foreign                |                          | 有                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| Minitab                              | .mtp                         | foreign                |                          | 有                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| Systat                               | .syd                         | foreign                |                          | 有                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| "XBASE"                              | データベースファイル         | .dbf                   | foreign                  | foreign                                    |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| Weka Attribute-Relation ファイル形式 | .arff                        | foreign                | foreign                  | 有                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| データ交換フォーマット               | .dif                         | utils                  |                          | 有                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| Fortran データ                       | 認識された拡張子はありません | utils                  |                          | 有                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| 固定幅フォーマットデータ             | .fwf                         | utils                  | utils                    | 有                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| gzipコンマ区切りデータ               | .csv.gz                      | utils                  | utils                    | 有                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| CSVY (CSV + YAML メタデータヘッダー) | .csvy                        | csvy                   | csvy                     | 無                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| EViews                               | .wf1                         | hexView                |                          | 無                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| Feather R/Python 交換フォーマット    | .feather                     | feather                | feather                  | 無                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| Fast Storage                         | .fst                         | fst                    | fst                      | 無                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| JSON                                 | .json                        | jsonlite               | jsonlite                 | 無                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| Matlab                               | .mat                         | rmatio                 | rmatio                   | 無                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| OpenDocument スプレッドシート        | .ods                         | readODS                | readODS                  | 無                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| HTML テーブル                        | .html                        | xml2                   | xml2                     | 無                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| Shallow XML ドキュメント             | .xml                         | xml2                   | xml2                     | 無                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| YAML                                 | .yml                         | yaml                   | yaml                     | 無                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
| クリップボード                       | tsv                          | clipr                  | clipr                    | 無                                         |
+--------------------------------------+------------------------------+------------------------+--------------------------+--------------------------------------------+
