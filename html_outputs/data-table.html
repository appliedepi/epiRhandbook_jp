<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>50 data.table パッケージを使用したデータ処理 | 疫学のための R ハンドブック</title>
<meta name="author" content="the handbook team">
<meta name="description" content="このハンドブックでは、データを整理しグルーピングする方法として、dplyr パッケージの「動詞」関数と magrittr パッケージのパイプ演算子 %&gt;% に焦点を当てています。一方、data.table パッケージは、R を使用していく上で出会うかもしれない、データ処理の代替手段を提供します。  50.1 データテーブルの概要 データテーブル（data...">
<meta name="generator" content="bookdown 0.29 with bs4_book()">
<meta property="og:title" content="50 data.table パッケージを使用したデータ処理 | 疫学のための R ハンドブック">
<meta property="og:type" content="book">
<meta property="og:description" content="このハンドブックでは、データを整理しグルーピングする方法として、dplyr パッケージの「動詞」関数と magrittr パッケージのパイプ演算子 %&gt;% に焦点を当てています。一方、data.table パッケージは、R を使用していく上で出会うかもしれない、データ処理の代替手段を提供します。  50.1 データテーブルの概要 データテーブル（data...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="50 data.table パッケージを使用したデータ処理 | 疫学のための R ハンドブック">
<meta name="twitter:description" content="このハンドブックでは、データを整理しグルーピングする方法として、dplyr パッケージの「動詞」関数と magrittr パッケージのパイプ演算子 %&gt;% に焦点を当てています。一方、data.table パッケージは、R を使用していく上で出会うかもしれない、データ処理の代替手段を提供します。  50.1 データテーブルの概要 データテーブル（data...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.25/datatables.js"></script><link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="libs/selectize-0.12.0/selectize.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/tabwid-1.1.0/tabwid.css" rel="stylesheet">
<link href="libs/tabwid-1.1.0/scrool.css" rel="stylesheet">
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script><script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script><script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.9/grViz.js"></script><script src="libs/d3-4.5.0/d3.min.js"></script><script src="libs/sankey-1/sankey.js"></script><script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><script src="libs/plotly-binding-4.10.0/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script><link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="libs/vis-9.1.0/vis-network.min.js"></script><script src="libs/visNetwork-binding-2.1.0/visNetwork.js"></script><link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script src="libs/plotly-basic-2.5.1/plotly-basic-2.5.1.min.js"></script><script src="libs/plotly-cartesian-2.5.1/plotly-cartesian-2.5.1.min.js"></script><script src="libs/proj4js-2.3.15/proj4.js"></script><link href="libs/highcharts-9.3.1/css/motion.css" rel="stylesheet">
<script src="libs/highcharts-9.3.1/highcharts.js"></script><script src="libs/highcharts-9.3.1/highcharts-3d.js"></script><script src="libs/highcharts-9.3.1/highcharts-more.js"></script><script src="libs/highcharts-9.3.1/modules/stock.js"></script><script src="libs/highcharts-9.3.1/modules/map.js"></script><script src="libs/highcharts-9.3.1/modules/data.js"></script><script src="libs/highcharts-9.3.1/modules/exporting.js"></script><script src="libs/highcharts-9.3.1/modules/offline-exporting.js"></script><script src="libs/highcharts-9.3.1/modules/drilldown.js"></script><script src="libs/highcharts-9.3.1/modules/item-series.js"></script><script src="libs/highcharts-9.3.1/modules/overlapping-datalabels.js"></script><script src="libs/highcharts-9.3.1/modules/annotations.js"></script><script src="libs/highcharts-9.3.1/modules/export-data.js"></script><script src="libs/highcharts-9.3.1/modules/funnel.js"></script><script src="libs/highcharts-9.3.1/modules/heatmap.js"></script><script src="libs/highcharts-9.3.1/modules/treemap.js"></script><script src="libs/highcharts-9.3.1/modules/sankey.js"></script><script src="libs/highcharts-9.3.1/modules/dependency-wheel.js"></script><script src="libs/highcharts-9.3.1/modules/organization.js"></script><script src="libs/highcharts-9.3.1/modules/solid-gauge.js"></script><script src="libs/highcharts-9.3.1/modules/streamgraph.js"></script><script src="libs/highcharts-9.3.1/modules/sunburst.js"></script><script src="libs/highcharts-9.3.1/modules/vector.js"></script><script src="libs/highcharts-9.3.1/modules/wordcloud.js"></script><script src="libs/highcharts-9.3.1/modules/xrange.js"></script><script src="libs/highcharts-9.3.1/modules/tilemap.js"></script><script src="libs/highcharts-9.3.1/modules/venn.js"></script><script src="libs/highcharts-9.3.1/modules/gantt.js"></script><script src="libs/highcharts-9.3.1/modules/timeline.js"></script><script src="libs/highcharts-9.3.1/modules/parallel-coordinates.js"></script><script src="libs/highcharts-9.3.1/modules/bullet.js"></script><script src="libs/highcharts-9.3.1/modules/coloraxis.js"></script><script src="libs/highcharts-9.3.1/modules/dumbbell.js"></script><script src="libs/highcharts-9.3.1/modules/lollipop.js"></script><script src="libs/highcharts-9.3.1/modules/series-label.js"></script><script src="libs/highcharts-9.3.1/plugins/motion.js"></script><script src="libs/highcharts-9.3.1/custom/reset.js"></script><script src="libs/highcharts-9.3.1/modules/boost.js"></script><script src="libs/highchart-binding-0.9.4/highchart.js"></script><script type="text/javascript">
        // window.addEventListener("load", function() {
        //     document.getElementById('toc').firstChild.innerHTML = "章目次"; 
        // });
        document.addEventListener("DOMContentLoaded", function() {
            document.getElementsByClassName("d-flex align-items-start justify-content-between")[0].children[0].children[0].innerHTML = "疫学のための R</br>ハンドブック";
            document.getElementById('toc').firstChild.innerHTML = "章目次"; 
            document.getElementById('main-nav').children[1].firstChild.innerHTML = "総目次";
            document.getElementById('search').setAttribute("placeholder", "検索");
        });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style_bs4.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">疫学のための R ハンドブック</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"></a></li>
<li class="book-part">本書について</li>
<li><a class="" href="editorial-style.html"><span class="header-section-number">1</span> 編集前記・技術注記</a></li>
<li><a class="" href="data-used.html"><span class="header-section-number">2</span> ハンドブックとデータのダウンロード</a></li>
<li class="book-part">基本編</li>
<li><a class="" href="basics.html"><span class="header-section-number">3</span> R の基礎</a></li>
<li><a class="" href="transition-to-R.html"><span class="header-section-number">4</span> Excel・Stata・SASとの比較</a></li>
<li><a class="" href="packages-suggested.html"><span class="header-section-number">5</span> 推奨パッケージ</a></li>
<li><a class="" href="r-projects.html"><span class="header-section-number">6</span> R プロジェクト</a></li>
<li><a class="" href="importing.html"><span class="header-section-number">7</span> データのインポート・エクスポート</a></li>
<li class="book-part">データマネジメント</li>
<li><a class="" href="cleaning.html"><span class="header-section-number">8</span> データクリーニングと主要関数</a></li>
<li><a class="" href="dates.html"><span class="header-section-number">9</span> 日付型データ</a></li>
<li><a class="" href="characters-strings.html"><span class="header-section-number">10</span> 文字型・文字列型データ</a></li>
<li><a class="" href="factors.html"><span class="header-section-number">11</span> 因子（ファクタ）型データ</a></li>
<li><a class="" href="pivoting.html"><span class="header-section-number">12</span> データの縦横変換</a></li>
<li><a class="" href="grouping.html"><span class="header-section-number">13</span> データのグループ化</a></li>
<li><a class="" href="joining-matching.html"><span class="header-section-number">14</span> データの結合</a></li>
<li><a class="" href="deduplication.html"><span class="header-section-number">15</span> 重複データの排除</a></li>
<li><a class="" href="iteration.html"><span class="header-section-number">16</span> ループと反復処理・リストの操作</a></li>
<li class="book-part">データ分析</li>
<li><a class="" href="tables-descriptive.html"><span class="header-section-number">17</span> 記述統計表の作り方</a></li>
<li><a class="" href="stat-tests.html"><span class="header-section-number">18</span> 基本的な統計的検定</a></li>
<li><a class="" href="regression.html"><span class="header-section-number">19</span> 単変量と多変量回帰</a></li>
<li><a class="" href="missing-data.html"><span class="header-section-number">20</span> データの欠損</a></li>
<li><a class="" href="standardization.html"><span class="header-section-number">21</span> 標準化率</a></li>
<li><a class="" href="moving-average.html"><span class="header-section-number">22</span> 移動平均</a></li>
<li><a class="" href="time-series.html"><span class="header-section-number">23</span> 時系列分析とアウトブレイクの検出</a></li>
<li><a class="" href="epidemic-models.html"><span class="header-section-number">24</span> エピデミックモデリング</a></li>
<li><a class="" href="contact-tracing.html"><span class="header-section-number">25</span> 接触者の追跡</a></li>
<li><a class="" href="survey-analysis.html"><span class="header-section-number">26</span> 標本調査データ分析</a></li>
<li><a class="" href="survival-analysis.html"><span class="header-section-number">27</span> 生存時間解析</a></li>
<li><a class="" href="gis.html"><span class="header-section-number">28</span> GIS の基本</a></li>
<li class="book-part">データの可視化</li>
<li><a class="" href="tables-presentation.html"><span class="header-section-number">29</span> 見やすい表の作り方</a></li>
<li><a class="" href="ggplot-basics.html"><span class="header-section-number">30</span> ggplot の基本</a></li>
<li><a class="" href="ggplot-tips.html"><span class="header-section-number">31</span> ggplotのヒント</a></li>
<li><a class="" href="epicurves.html"><span class="header-section-number">32</span> 流行曲線（エピカーブ）</a></li>
<li><a class="" href="age-pyramid.html"><span class="header-section-number">33</span> 人口ピラミッドとリッカート尺度</a></li>
<li><a class="" href="heatmaps.html"><span class="header-section-number">34</span> ヒートマップ</a></li>
<li><a class="" href="diagrams.html"><span class="header-section-number">35</span> フローチャート・サンキー図・タイムライン</a></li>
<li><a class="" href="combination-analysis.html"><span class="header-section-number">36</span> 複数回答データの分析</a></li>
<li><a class="" href="transmission-chains.html"><span class="header-section-number">37</span> 感染連鎖</a></li>
<li><a class="" href="phylogenetic-trees.html"><span class="header-section-number">38</span> 系統樹</a></li>
<li><a class="" href="interactive-plots.html"><span class="header-section-number">39</span> 動的な図の作成</a></li>
<li class="book-part">レポートとダッシュボード</li>
<li><a class="" href="rmarkdown.html"><span class="header-section-number">40</span> R Markdown で作るレポート</a></li>
<li><a class="" href="reportfactory.html"><span class="header-section-number">41</span> ルーチンで作成するレポートの整理</a></li>
<li><a class="" href="flexdashboard.html"><span class="header-section-number">42</span> R Markdownで作るダッシュボード</a></li>
<li><a class="" href="shiny-basics.html"><span class="header-section-number">43</span> Shiny で作るダッシュボード</a></li>
<li class="book-part">その他</li>
<li><a class="" href="writing-functions.html"><span class="header-section-number">44</span> 関数の作成</a></li>
<li><a class="" href="directories.html"><span class="header-section-number">45</span> ディレクトリの操作</a></li>
<li><a class="" href="collaboration.html"><span class="header-section-number">46</span> Git と Github を使ったバージョン管理と共同作業</a></li>
<li><a class="" href="errors.html"><span class="header-section-number">47</span> よくあるエラー</a></li>
<li><a class="" href="help.html"><span class="header-section-number">48</span> ヘルプ</a></li>
<li><a class="" href="network-drives.html"><span class="header-section-number">49</span> ネットワークドライブで R を使用する場合</a></li>
<li><a class="active" href="data-table.html"><span class="header-section-number">50</span> data.table パッケージを使用したデータ処理</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="data-table" class="section level1" number="50">
<h1>
<span class="header-section-number">50</span> data.table パッケージを使用したデータ処理<a class="anchor" aria-label="anchor" href="#data-table"><i class="fas fa-link"></i></a>
</h1>
<p>このハンドブックでは、データを整理しグルーピングする方法として、<strong>dplyr</strong> パッケージの「動詞」関数と <strong>magrittr</strong> パッケージのパイプ演算子 <code>%&gt;%</code> に焦点を当てています。一方、<strong>data.table</strong> パッケージは、R を使用していく上で出会うかもしれない、データ処理の代替手段を提供します。</p>
<!-- ======================================================= -->
<div id="データテーブルの概要" class="section level2" number="50.1">
<h2>
<span class="header-section-number">50.1</span> データテーブルの概要<a class="anchor" aria-label="anchor" href="#%E3%83%87%E3%83%BC%E3%82%BF%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%81%AE%E6%A6%82%E8%A6%81"><i class="fas fa-link"></i></a>
</h2>
<p>データテーブル（data table）は、データフレームのような 2 次元のデータ構造であり、複雑なグルーピング操作を実行できます。data.table 構文は、行、列、およびグループに対して操作を実行できるように構成されています。</p>
<p>data.table 構文は <strong>DT[i, j, by]</strong> と表記され、<strong>i</strong>、<strong>j</strong>、<strong>by</strong> という 3 つの部品で構成されています。 <strong>i</strong> 引数を使用すると、必要な行をサブセット化できます。<strong>j</strong> 引数を使用すると、列を操作できます。<strong>by</strong> 引数を使用すると、グループごとに列を操作できます。</p>
<p>この章では、以下のトピックについて説明します。</p>
<ul>
<li>データのインポートと <code>fread()</code> および <code>fwrite()</code> の使用</li>
<li>
<strong>i</strong> 引数を使用した行の選択とフィルタリング</li>
<li>ヘルパー関数 <code>%like%</code>、<code>%chin%</code>,、<code>%between%</code> の使用</li>
<li>
<strong>j</strong> 引数を使用した列の選択と計算</li>
<li>
<strong>by</strong> 引数を使用したグループごとの計算</li>
<li>
<code>:=</code> を使用してデータテーブルにデータを追加および更新する</li>
</ul>
<!-- ======================================================= -->
</div>
<div id="パッケージの読み込みとデータのインポート" class="section level2" number="50.2">
<h2>
<span class="header-section-number">50.2</span> パッケージの読み込みとデータのインポート<a class="anchor" aria-label="anchor" href="#%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%81%AE%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF%E3%81%A8%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E3%82%A4%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%88"><i class="fas fa-link"></i></a>
</h2>
<div id="パッケージの読み込み-25" class="section level3 unnumbered">
<h3>パッケージの読み込み<a class="anchor" aria-label="anchor" href="#%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%81%AE%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF-25"><i class="fas fa-link"></i></a>
</h3>
<p><strong>pacman</strong> パッケージの <code><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load()</a></code> 関数を使用して、この分析に必要なパッケージを読み込み（および必要に応じてインストールし）ます。</p>
<div class="sourceCode" id="cb1985"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span></span>
<span>  <span class="va">rio</span>,        <span class="co"># データのインポート</span></span>
<span>  <span class="va">data.table</span>, <span class="co"># データのグループ化</span></span>
<span>  <span class="va">tidyverse</span>,  <span class="co"># この章でパイプ（%&gt;%）関数を使用可にする</span></span>
<span>  <span class="va">here</span> </span>
<span>  <span class="op">)</span> </span></code></pre></div>
</div>
<div id="データのインポート-20" class="section level3 unnumbered">
<h3>データのインポート<a class="anchor" aria-label="anchor" href="#%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E3%82%A4%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%88-20"><i class="fas fa-link"></i></a>
</h3>
<p>この章では、ハンドブック全体で参照されている症例ラインリストを使用して、<strong>data.table</strong> パッケージのコア機能のいくつかを説明します。</p>
<p>エボラ出血熱の流行をシミュレートしたデータセットをインポートします。お手元の環境でこの章の内容を実行したい方は、<a href="https://github.com/epirhandbook/Epi_R_handbook/raw/master/data/case_linelists/linelist_cleaned.rds" class="download-button">クリック</a>して「前処理された」ラインリスト（linelist）データをダウンロードしてください&gt;（.rds 形式で取得できます）。データは <strong>rio</strong> パッケージの <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> を利用してインポートしましょう（<strong>rio</strong> パッケージは、.xlsx、.csv、.rds など様々な種類のファイルを取り扱うことができます。詳細は、<a href="importing.html#importing">インポートとエクスポート</a> の章をご覧ください。）<code>data.table()</code> を使用してデータフレームをデータテーブルに変換します。</p>
<div class="sourceCode" id="cb1986"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"linelist_cleaned.xlsx"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">data.table</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><code>fread()</code> 関数は、.csv ファイルなどの普通の区切り付きファイルをデータテーブルに直接インポートするために使用されます。この関数と対を成す <code>fwrite()</code> は、普通の区切り付きファイルへデータテーブルを書き込むために使用されます。これらの関数は、大規模なデータベースにとって非常に高速で計算効率の高い選択肢です。</p>
<p><code>linelist</code> の最初の 20 行を表示します。</p>
<p>データフレームに使用される <code><a href="https://rdrr.io/r/base/dim.html">dim()</a></code> などの R の <strong>base</strong> パッケージ（以下、<strong>base</strong> R）のコマンドは、データテーブルにも使用できます。</p>
<div class="sourceCode" id="cb1987"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span> <span class="co">#データテーブルの行と列の数を示す</span></span></code></pre></div>
<pre><code>## [1] 5888   30</code></pre>
<!-- ======================================================= -->
</div>
</div>
<div id="i-引数-行の選択とフィルタリング" class="section level2" number="50.3">
<h2>
<span class="header-section-number">50.3</span> i 引数： 行の選択とフィルタリング<a class="anchor" aria-label="anchor" href="#i-%E5%BC%95%E6%95%B0-%E8%A1%8C%E3%81%AE%E9%81%B8%E6%8A%9E%E3%81%A8%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF%E3%83%AA%E3%83%B3%E3%82%B0"><i class="fas fa-link"></i></a>
</h2>
<p>先ほど説明した <strong>DT[i, j, by]</strong> data.table 構文を使い、行番号または論理式のいずれかを使用して行をフィルタリングできます。i 引数は構文における最初の引数です。 したがって、<strong>DT[i]</strong> または <strong>DT[i,]</strong> 構文を使用できます。</p>
<p>以下の 1 つ目の例ではデータテーブルの最初の 5 行を取得し、2 つ目の例では 18 歳以上の症例をサブセット化し、3 つ目の例では 18 歳以上であるが Central Hospital で診断されていない症例をサブセット化します。</p>
<div class="sourceCode" id="cb1989"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="co">#1 行目から 5 行目を取得</span></span>
<span><span class="va">linelist</span><span class="op">[</span><span class="va">age</span> <span class="op">&gt;=</span> <span class="fl">18</span><span class="op">]</span> <span class="co">#18 歳以上をサブセット化</span></span>
<span><span class="va">linelist</span><span class="op">[</span><span class="va">age</span> <span class="op">&gt;=</span> <span class="fl">18</span> <span class="op">&amp;</span> <span class="va">hospital</span> <span class="op">!=</span> <span class="st">"Central Hospital"</span><span class="op">]</span> <span class="co">#18 歳以上であるが、Central Hospital で診断されていない症例のサブセット</span></span></code></pre></div>
<p>i 引数に .N を使用すると、データテーブルの行の総数を表示します。 この書式は、行番号によるサブセット化に使用できます。</p>
<div class="sourceCode" id="cb1990"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span><span class="op">[</span><span class="va">.N</span><span class="op">]</span> <span class="co">#最後の行を取得</span></span>
<span><span class="va">linelist</span><span class="op">[</span><span class="fl">15</span><span class="op">:</span><span class="va">.N</span><span class="op">]</span> <span class="co">#15 行目から最後の行を取得</span></span></code></pre></div>
<div id="ヘルパー関数を使用したフィルタリング" class="section level3 unnumbered">
<h3>ヘルパー関数を使用したフィルタリング<a class="anchor" aria-label="anchor" href="#%E3%83%98%E3%83%AB%E3%83%91%E3%83%BC%E9%96%A2%E6%95%B0%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF%E3%83%AA%E3%83%B3%E3%82%B0"><i class="fas fa-link"></i></a>
</h3>
<p>data.table 構文では、行のサブセット化を容易にするヘルパー関数を使用します。<code>%like%</code> 関数は列内をパターンマッチングで比較するために使用され、<code>%chin%</code> は特定の文字が含まれるか比較するために使用され、<code>%between%</code> 関数は事前に用意した範囲に数字型の列を抽出するために使用されます。</p>
<p>以下では、3 点を例示します。</p>
<ul>
<li>hospital 列に文字列「Hospital」が含まれる行をフィルタリングする</li>
<li>予後が「回復」または「死」である行をフィルタリングする</li>
<li>年齢の範囲が 40〜60 歳の行をフィルタリングする</li>
</ul>
<div class="sourceCode" id="cb1991"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span><span class="op">[</span><span class="va">hospital</span> <span class="op">%like%</span> <span class="st">"Hospital"</span><span class="op">]</span> <span class="co">#hospital 列に文字列「Hospital」が含まれる行をフィルタリングする</span></span>
<span><span class="va">linelist</span><span class="op">[</span><span class="va">outcome</span> <span class="op">%chin%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Recover"</span>, <span class="st">"Death"</span><span class="op">)</span><span class="op">]</span> <span class="co">#予後が「回復」または「死」である行をフィルタリングする</span></span>
<span><span class="va">linelist</span><span class="op">[</span><span class="va">age</span> <span class="op">%between%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">60</span><span class="op">)</span><span class="op">]</span> <span class="co">#年齢の範囲が 40〜60 歳の行をフィルタリングする</span></span>
<span></span>
<span><span class="co">#%between% を使う際は長さ 2 のベクトルが必要だが、%chin% を使う場合は長さ 1 以上のベクトルが使用できる。</span></span></code></pre></div>
</div>
</div>
<div id="j-引数列の選択と計算" class="section level2" number="50.4">
<h2>
<span class="header-section-number">50.4</span> j 引数：列の選択と計算<a class="anchor" aria-label="anchor" href="#j-%E5%BC%95%E6%95%B0%E5%88%97%E3%81%AE%E9%81%B8%E6%8A%9E%E3%81%A8%E8%A8%88%E7%AE%97"><i class="fas fa-link"></i></a>
</h2>
<p><strong>DT[i, j, by]</strong> data.table 構文を使用すると、数値または名前を使用して列を選択できます。<strong>j</strong> 引数は構文における 2 番目の引数です。 したがって、<strong>DT[, j]</strong> 構文が使用されます。<strong>j</strong> 引数の計算を容易にするために、選択する列は <code><a href="https://rdrr.io/r/base/list.html">list()</a></code> または <code>.()</code> のいずれかを使用してまとめます。</p>
<div id="列の選択" class="section level3 unnumbered">
<h3>列の選択<a class="anchor" aria-label="anchor" href="#%E5%88%97%E3%81%AE%E9%81%B8%E6%8A%9E"><i class="fas fa-link"></i></a>
</h3>
<p>以下の 1 つ目の例では、データテーブルの 1 番目、3 番目、5 番目の列を取得し、2 つ目の例では、身長、体重、性別の列を除くすべての列を選択します。3 つ目の例では、<code>.()</code> を使用して、<strong>case_id</strong> 列と<strong>outcome</strong> 列を選択します。</p>
<div class="sourceCode" id="cb1992"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">linelist</span><span class="op">[</span> , <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"age"</span>, <span class="st">"wt_kg"</span>, <span class="st">"ht_cm"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">linelist</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">case_id</span>, <span class="va">outcome</span><span class="op">)</span><span class="op">]</span> <span class="co">#linelist[ , .(case_id, outcome)]でも可</span></span></code></pre></div>
</div>
<div id="列内の計算" class="section level3 unnumbered">
<h3>列内の計算<a class="anchor" aria-label="anchor" href="#%E5%88%97%E5%86%85%E3%81%AE%E8%A8%88%E7%AE%97"><i class="fas fa-link"></i></a>
</h3>
<p><strong>i</strong> 引数と <strong>j</strong> 引数を組み合わせることにより、行をフィルタリングして列内の計算が可能です。 <strong>j</strong> 引数に <strong>.N</strong> を使用すると、データテーブルの行の総数を表し、行フィルタリング後に行数を取得するのに役立ちます。</p>
<p>以下では、3 点を例示します。</p>
<ul>
<li>入院 7 日以上の症例数をカウント</li>
<li>“Military” を病院名に含む病院で死亡した症例の平均年齢</li>
<li>Central Hospital で回復した症例の年齢の標準偏差、中央値、平均</li>
</ul>
<div class="sourceCode" id="cb1993"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span><span class="op">[</span><span class="va">days_onset_hosp</span> <span class="op">&gt;</span> <span class="fl">7</span> , <span class="va">.N</span><span class="op">]</span></span></code></pre></div>
<pre><code>## [1] 189</code></pre>
<div class="sourceCode" id="cb1995"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span><span class="op">[</span><span class="va">hospital</span> <span class="op">%like%</span> <span class="st">"Military"</span> <span class="op">&amp;</span> <span class="va">outcome</span> <span class="op">%chin%</span> <span class="st">"Death"</span>, <span class="fu">.</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">age</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="co">#na.rm = T は N/A 値を除外します</span></span></code></pre></div>
<pre><code>##         V1
## 1: 15.9084</code></pre>
<div class="sourceCode" id="cb1997"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span><span class="op">[</span><span class="va">hospital</span> <span class="op">==</span> <span class="st">"Central Hospital"</span> <span class="op">&amp;</span> <span class="va">outcome</span> <span class="op">==</span> <span class="st">"Recover"</span>, </span>
<span>                 <span class="fu">.</span><span class="op">(</span>mean_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">age</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>                   median_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">age</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>                   sd_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">age</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="co">#この構文はヘルパー関数を使用しないが、使用する場合と同様に機能する</span></span></code></pre></div>
<pre><code>##    mean_age median_age   sd_age
## 1: 16.85185         14 12.93857</code></pre>
<p>j 引数において .() 構文を使用すると、計算が容易になり、データテーブルを戻り値と返し、列に名前を付けることができます。</p>
</div>
</div>
<div id="by-引数グルーピングを用いた計算" class="section level2" number="50.5">
<h2>
<span class="header-section-number">50.5</span> by 引数：グルーピングを用いた計算<a class="anchor" aria-label="anchor" href="#by-%E5%BC%95%E6%95%B0%E3%82%B0%E3%83%AB%E3%83%BC%E3%83%94%E3%83%B3%E3%82%B0%E3%82%92%E7%94%A8%E3%81%84%E3%81%9F%E8%A8%88%E7%AE%97"><i class="fas fa-link"></i></a>
</h2>
<p><strong>by</strong> 引数は、<strong>DT[i, j, by]</strong> data.table 構文の 3 番目の引数です。 <strong>by</strong> 引数には、文字型ベクトルと <code><a href="https://rdrr.io/r/base/list.html">list()</a></code> 構文または <code>.()</code> 構文を使用できます。 <strong>by</strong> 引数に <code>.()</code> 構文を使用すると、列名をその場で変更できます。</p>
<p>以下では、3 点を例示します。</p>
<ul>
<li>症例数を病院ごとにグルーピング</li>
<li>18 歳以上の症例を、性別や回復したか死亡したかによってグルーピングし、身長と体重の平均を計算</li>
<li>7 日間以上入院したグループで、入院した月と入院した病院に応じて症例数を集計</li>
</ul>
<div class="sourceCode" id="cb1999"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span><span class="op">[</span>, <span class="va">.N</span>, <span class="fu">.</span><span class="op">(</span><span class="va">hospital</span><span class="op">)</span><span class="op">]</span> <span class="co">#病院別の症例数</span></span></code></pre></div>
<pre><code>##                                hospital    N
## 1:                                Other  885
## 2:                              Missing 1469
## 3: St. Mark's Maternity Hospital (SMMH)  422
## 4:                        Port Hospital 1762
## 5:                    Military Hospital  896
## 6:                     Central Hospital  454</code></pre>
<div class="sourceCode" id="cb2001"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span><span class="op">[</span><span class="va">age</span> <span class="op">&gt;</span> <span class="fl">18</span>, <span class="fu">.</span><span class="op">(</span>mean_wt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">wt_kg</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>                             mean_ht <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ht_cm</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span>, <span class="fu">.</span><span class="op">(</span><span class="va">gender</span>, <span class="va">outcome</span><span class="op">)</span><span class="op">]</span> <span class="co">#NA は、データが欠測しているカテゴリを表す</span></span></code></pre></div>
<pre><code>##    gender outcome  mean_wt  mean_ht
## 1:      m Recover 71.90227 178.1977
## 2:      f   Death 63.27273 159.9448
## 3:      m   Death 71.61770 175.4726
## 4:      f    &lt;NA&gt; 64.49375 162.7875
## 5:      m    &lt;NA&gt; 72.65505 176.9686
## 6:      f Recover 62.86498 159.2996
## 7:   &lt;NA&gt; Recover 67.21429 175.2143
## 8:   &lt;NA&gt;   Death 69.16667 170.7917
## 9:   &lt;NA&gt;    &lt;NA&gt; 70.25000 175.5000</code></pre>
<div class="sourceCode" id="cb2003"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span><span class="op">[</span><span class="va">days_onset_hosp</span> <span class="op">&gt;</span> <span class="fl">7</span>, <span class="va">.N</span>, <span class="fu">.</span><span class="op">(</span>month <span class="op">=</span> <span class="fu">month</span><span class="op">(</span><span class="va">date_hospitalisation</span><span class="op">)</span>, <span class="va">hospital</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code>##     month                             hospital  N
##  1:     5                    Military Hospital  3
##  2:     6                        Port Hospital  4
##  3:     7                        Port Hospital  8
##  4:     8 St. Mark's Maternity Hospital (SMMH)  5
##  5:     8                    Military Hospital  9
##  6:     8                                Other 10
##  7:     8                        Port Hospital 10
##  8:     9                        Port Hospital 28
##  9:     9                              Missing 27
## 10:     9                     Central Hospital 10
## 11:     9 St. Mark's Maternity Hospital (SMMH)  6
## 12:    10                              Missing  2
## 13:    10                    Military Hospital  3
## 14:     3                        Port Hospital  1
## 15:     4                    Military Hospital  1
## 16:     5                                Other  2
## 17:     5                     Central Hospital  1
## 18:     5                              Missing  1
## 19:     6                              Missing  7
## 20:     6 St. Mark's Maternity Hospital (SMMH)  2
## 21:     6                    Military Hospital  1
## 22:     7                    Military Hospital  3
## 23:     7                                Other  1
## 24:     7                              Missing  2
## 25:     7 St. Mark's Maternity Hospital (SMMH)  1
## 26:     8                     Central Hospital  2
## 27:     8                              Missing  6
## 28:     9                                Other  9
## 29:     9                    Military Hospital 11
## 30:    10                        Port Hospital  3
## 31:    10                                Other  4
## 32:    10 St. Mark's Maternity Hospital (SMMH)  1
## 33:    10                     Central Hospital  1
## 34:    11                              Missing  2
## 35:    11                        Port Hospital  1
## 36:    12                        Port Hospital  1
##     month                             hospital  N</code></pre>
<p>data.table 構文では、次のように式を組み合わせることもできます。</p>
<div class="sourceCode" id="cb2005"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span><span class="op">[</span>, <span class="va">.N</span>, <span class="fu">.</span><span class="op">(</span><span class="va">hospital</span><span class="op">)</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="op">-</span><span class="va">N</span><span class="op">)</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="co">#1 番目の構文は病院ごとにすべての症例を選択し、2 番目の構文は症例を降順で並べ替え、3 番目の構文は症例数上位 3 つの病院をサブセット化する</span></span></code></pre></div>
<pre><code>##             hospital    N
## 1:     Port Hospital 1762
## 2:           Missing 1469
## 3: Military Hospital  896</code></pre>
<p>前述の例では、データテーブルの行は新しい症例に相当するという仮定に従っているため、<strong>.N</strong> を使用してデータテーブルの行数を表すことができます。個別の症例数を表すもう 1 つの便利な関数は、<code>uniqueN()</code> です。この関数は、与えられた入力から、重複のない個別の総数を取得できます。 以下のように実行します。</p>
<div class="sourceCode" id="cb2007"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="fu">uniqueN</span><span class="op">(</span><span class="va">gender</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="co"># j 引数の .() はデータテーブルを戻り値として返すことを覚えておいてください</span></span></code></pre></div>
<pre><code>##    V1
## 1:  3</code></pre>
<p>性別の列に含まれる個別の値は m、f、および N/A であるため、戻り値は 3 になります。 与えられた入力の個別の値すべてを取得する base R 関数 <code><a href="https://rdrr.io/r/base/unique.html">unique()</a></code> と比較してください。</p>
<div class="sourceCode" id="cb2009"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">gender</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code>##      V1
## 1:    m
## 2:    f
## 3: &lt;NA&gt;</code></pre>
<p>特定の月における個別の症例数を取得するには、以下のように記述します。</p>
<div class="sourceCode" id="cb2011"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="fu">uniqueN</span><span class="op">(</span><span class="va">case_id</span><span class="op">)</span><span class="op">)</span>, <span class="fu">.</span><span class="op">(</span>month <span class="op">=</span> <span class="fu">month</span><span class="op">(</span><span class="va">date_hospitalisation</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code>##     month   V1
##  1:     5   62
##  2:     6  100
##  3:     7  198
##  4:     8  509
##  5:     9 1170
##  6:    10 1228
##  7:    11  813
##  8:    12  576
##  9:     1  434
## 10:     2  310
## 11:     3  290
## 12:     4  198</code></pre>
</div>
<div id="データテーブルへのデータの追加と更新" class="section level2" number="50.6">
<h2>
<span class="header-section-number">50.6</span> データテーブルへのデータの追加と更新<a class="anchor" aria-label="anchor" href="#%E3%83%87%E3%83%BC%E3%82%BF%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%81%B8%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E8%BF%BD%E5%8A%A0%E3%81%A8%E6%9B%B4%E6%96%B0"><i class="fas fa-link"></i></a>
</h2>
<p><code>:=</code> 演算子は、データテーブルへデータを追加または更新するために使用されます。 データテーブルへの列の追加は、以下の方法で実行できます。</p>
<div class="sourceCode" id="cb2013"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span><span class="op">[</span>, <span class="va">adult</span> <span class="op">:=</span> <span class="va">age</span> <span class="op">&gt;=</span> <span class="fl">18</span><span class="op">]</span> <span class="co"># 1 列追加</span></span>
<span><span class="va">linelist</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"child"</span>, <span class="st">"wt_lbs"</span><span class="op">)</span> <span class="op">:=</span> <span class="fu">.</span><span class="op">(</span><span class="va">age</span> <span class="op">&lt;</span> <span class="fl">18</span>, <span class="va">wt_kg</span><span class="op">*</span><span class="fl">2.204</span><span class="op">)</span><span class="op">]</span> <span class="co">#複数の列を追加するには、c("") と list() または .() 構文が必要</span></span>
<span><span class="va">linelist</span><span class="op">[</span>, <span class="fu">`:=`</span> <span class="op">(</span>bmi_in_range <span class="op">=</span> <span class="op">(</span><span class="va">bmi</span> <span class="op">&gt;</span> <span class="fl">16</span> <span class="op">&amp;</span> <span class="va">bmi</span> <span class="op">&lt;</span> <span class="fl">40</span><span class="op">)</span>,</span>
<span>                         no_infector_source_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">infector</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">source</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="co">#この方法では、関数演算子 `:=` として := を使用</span></span>
<span><span class="va">linelist</span><span class="op">[</span>, <span class="va">adult</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span> <span class="co">#列の削除</span></span></code></pre></div>
<p>より複雑な集計は、入門の範囲を超えています。本章ではデータのグルーピングと整理のために、一般的で実行可能な <strong>dplyr</strong> パッケージの代替手段を提供することを目的としています。<strong>data.table</strong> パッケージは、読みやすいコードを可能にする優れたパッケージです。</p>
</div>
<div id="参考資料-38" class="section level2" number="50.7">
<h2>
<span class="header-section-number">50.7</span> 参考資料<a class="anchor" aria-label="anchor" href="#%E5%8F%82%E8%80%83%E8%B3%87%E6%96%99-38"><i class="fas fa-link"></i></a>
</h2>
<p>詳細については、以下の資料をご覧ください。
* <a href="https://cran.r-project.org/web/packages/data.table/vignettes/datatable-intro.html" class="uri">https://cran.r-project.org/web/packages/data.table/vignettes/datatable-intro.html</a>
* <a href="https://github.com/Rdatatable/data.table" class="uri">https://github.com/Rdatatable/data.table</a>
* <a href="https://s3.amazonaws.com/assets.datacamp.com/img/blog/data+table+cheat+sheet.pdf" class="uri">https://s3.amazonaws.com/assets.datacamp.com/img/blog/data+table+cheat+sheet.pdf</a>
* <a href="https://www.machinelearningplus.com/data-manipulation/datatable-in-r-complete-guide/" class="uri">https://www.machinelearningplus.com/data-manipulation/datatable-in-r-complete-guide/</a>
* <a href="https://www.datacamp.com/community/tutorials/data-table-r-tutorial" class="uri">https://www.datacamp.com/community/tutorials/data-table-r-tutorial</a></p>
<p>グルーピングされたデータに対して任意の要約機能を実行できます。 詳細については、こちらのチートシートをご参照ください。
<a href="https://s3.amazonaws.com/assets.datacamp.com/blog_assets/datatable_Cheat_Sheet_R.pdf" class="uri">https://s3.amazonaws.com/assets.datacamp.com/blog_assets/datatable_Cheat_Sheet_R.pdf</a></p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="network-drives.html"><span class="header-section-number">49</span> ネットワークドライブで R を使用する場合</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#data-table"><span class="header-section-number">50</span> data.table パッケージを使用したデータ処理</a></li>
<li><a class="nav-link" href="#%E3%83%87%E3%83%BC%E3%82%BF%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%81%AE%E6%A6%82%E8%A6%81"><span class="header-section-number">50.1</span> データテーブルの概要</a></li>
<li>
<a class="nav-link" href="#%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%81%AE%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF%E3%81%A8%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E3%82%A4%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%88"><span class="header-section-number">50.2</span> パッケージの読み込みとデータのインポート</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%81%AE%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF-25">パッケージの読み込み</a></li>
<li><a class="nav-link" href="#%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E3%82%A4%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%88-20">データのインポート</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#i-%E5%BC%95%E6%95%B0-%E8%A1%8C%E3%81%AE%E9%81%B8%E6%8A%9E%E3%81%A8%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF%E3%83%AA%E3%83%B3%E3%82%B0"><span class="header-section-number">50.3</span> i 引数： 行の選択とフィルタリング</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#%E3%83%98%E3%83%AB%E3%83%91%E3%83%BC%E9%96%A2%E6%95%B0%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF%E3%83%AA%E3%83%B3%E3%82%B0">ヘルパー関数を使用したフィルタリング</a></li></ul>
</li>
<li>
<a class="nav-link" href="#j-%E5%BC%95%E6%95%B0%E5%88%97%E3%81%AE%E9%81%B8%E6%8A%9E%E3%81%A8%E8%A8%88%E7%AE%97"><span class="header-section-number">50.4</span> j 引数：列の選択と計算</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%E5%88%97%E3%81%AE%E9%81%B8%E6%8A%9E">列の選択</a></li>
<li><a class="nav-link" href="#%E5%88%97%E5%86%85%E3%81%AE%E8%A8%88%E7%AE%97">列内の計算</a></li>
</ul>
</li>
<li><a class="nav-link" href="#by-%E5%BC%95%E6%95%B0%E3%82%B0%E3%83%AB%E3%83%BC%E3%83%94%E3%83%B3%E3%82%B0%E3%82%92%E7%94%A8%E3%81%84%E3%81%9F%E8%A8%88%E7%AE%97"><span class="header-section-number">50.5</span> by 引数：グルーピングを用いた計算</a></li>
<li><a class="nav-link" href="#%E3%83%87%E3%83%BC%E3%82%BF%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%81%B8%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E8%BF%BD%E5%8A%A0%E3%81%A8%E6%9B%B4%E6%96%B0"><span class="header-section-number">50.6</span> データテーブルへのデータの追加と更新</a></li>
<li><a class="nav-link" href="#%E5%8F%82%E8%80%83%E8%B3%87%E6%96%99-38"><span class="header-section-number">50.7</span> 参考資料</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>疫学のための R ハンドブック</strong>" was written by the handbook team. It was last built on 2022-10-04.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
